.. Set the default domain and role, for limiting the markup overhead.
.. default-domain:: py
.. default-role:: any

.. _report_ini:

report.ini
=============
.. sectionauthor:: Frédéric MEZOU <frederic.mezou@free.fr>

This file contains the configuration of report generated by the `lapptrack`
script. It use a structure similar to what’s found in Microsoft Windows INI
files, and parse with the `configparser` module of the Python standard library.
See the 'Supported INI File Structure' section to have details about the file
format.

The configuration consists of two main sections and one section per
handler (send a mail, write in a file, write in a stream) such as below.

* :ref:`core-section` contains configuration items for the report processor

* :ref:`attributes-section` contains contains named keyword used in the template
  report

* :ref:`mailhandler-section` contains configuration items to send the activity
  report in a mail

* :ref:`filehandler-section` contains configuration items to write the activity
  report in a file

* :ref:`streamhandler-section` contains configuration items to write the
  activity report in a stream

The following items details each sections and the associated options, and give
an example. The `report.example.ini` topic give a whole example.

.. _core-section:

Core Section
------------
The ``[core]`` section contains configuration items for the report processor.

====================  ==========================================================
``handlers``          (mandatory) is the list of handlers to publish the report.
                      Each handler has to have a corresponding section for its
                      own configuration.
``template``          (optional) is the full path name of the template file. The
                      `report-template` describes the format of the template
                      file. The default value is ``report_template.html``.
====================  ==========================================================

Example of a ``[core]`` section

.. literalinclude:: /lapptrack/support/report.example.ini
   :language: ini
   :lines: 14-16

.. _attributes-section:

Attributes Section
------------------
The ``[attributes]`` section contains named keyword used in the template report
(see `template` item in the `core-section`.

Theses attributes are used in the header and tail sections of the report (see
``Title``, ``BodyStart``, ``BodyEnd``, ``Tail`` sections in the
`report-template`). The :file:`report_template.html` doesn't use any additional
attribute, so this section is empty if you use the default templates.

Example of a ``[attributes]`` section

.. literalinclude:: /lapptrack/support/report.example.ini
   :language: ini
   :lines: 23-24

.. _mailhandler-section:

Mail Handler Section
--------------------
The ``[mailhandler]`` section contains configuration items to send the activity
report in a mail.

====================  ==========================================================
``class``             (optional) indicates the handler’s class (as determined in
                      the report module). By default, the name of the section is
                      used as the class name.
``host``              (mandatory) is a string containing the full qualified name
                      of the SMTP server host, or a 2-tuple containing the full
                      qualified name of the SMTP server and the port number to
                      use.
``credentials``       (optional) is a 2-tuple containing the username and the
                      password to connect to the SMTP server.
``from_address``      (optional) is a string containing the mail addresses of
                      the sender. If not specified, the address is set to the
                      local host name. (see `smtplib.SMTP`)
``mail_sent``         (optional) is the full path name of the folder where a
                      copy of the mail will be written. An empty string does
                      nothing.
``pending_mail``      (optional) is the full path name of the folder where a
                      copy of the mail will be written until it is sent. It
                      avoid to lost mail if the mail server configuration is
                      erroneous or if the mail server doesn't answer. An empty
                      string does nothing.
``to_addresses``      (mandatory) is a string or a list containing the mail
                      addresses of the recipient.
``subject``           (optional) is a string containing the mail subject. An
                      empty string does nothing.
====================  ==========================================================

Example of a ``[mailhandler]`` section

.. literalinclude:: /lapptrack/support/report.example.ini
   :language: ini
   :lines: 55-65

.. _filehandler-section:

File Handler Section
--------------------
The ``[filehandler]`` section contains configuration items to write the activity
report in a file

====================  ==========================================================
``class``             (optional) indicates the handler’s class (as determined in
                      the report module). By default, the name of the section is
                      used as the class name.
``filename``          (mandatory) is a string containing the full path name of
                      the destination file.
``mode``              (optional) is a string specifying the mode in which the
                      file is opened. (see `open`)
====================  ==========================================================

Example of a ``[filehandler]`` section

.. literalinclude:: /lapptrack/support/report.example.ini
   :language: ini
   :lines: 74-77

.. _streamhandler-section:

Stream Handler Section
----------------------
The ``[streamhandler]`` section contains configuration items to write the
activity report in a stream.

====================  ==========================================================
``class``             (optional) indicates the handler’s class (as determined in
                      the report module). By default, the name of the section is
                      used as the class name.
``stream``            (optional) is a string specifying the :data:`standard
                      stream <sys.stdout>` on which report will be written.
                      By default, ``sys.stdout`` will be used.
====================  ==========================================================

Example of a ``[streamhandler]`` section

.. literalinclude:: /lapptrack/support/report.example.ini
   :language: ini
   :lines: 85-87

.. _report.example.ini:

Example of report.ini
----------------- ---

.. literalinclude:: /lapptrack/support/report.example.ini
   :language: ini

